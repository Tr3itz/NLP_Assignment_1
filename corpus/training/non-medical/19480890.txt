In trigonometry, the law of cosines (also known as the cosine formula or cosine rule) relates the lengths of the sides of a triangle to the cosine of one of its angles. For a triangle with sides 
  
    
      
        a
        ,
      
    
    {\displaystyle a,}
   
  
    
      
        b
        ,
      
    
    {\displaystyle b,}
   and 
  
    
      
        c
        ,
      
    
    {\displaystyle c,}
   opposite respective angles 
  
    
      
        α
        ,
      
    
    {\displaystyle \alpha ,}
   
  
    
      
        β
        ,
      
    
    {\displaystyle \beta ,}
   and 
  
    
      
        γ
      
    
    {\displaystyle \gamma }
   (see Fig. 1), the law of cosines states:

  
    
      
        
          
            
              
                
                  c
                  
                    2
                  
                
              
              
                
                =
                
                  a
                  
                    2
                  
                
                +
                
                  b
                  
                    2
                  
                
                −
                2
                a
                b
                cos
                ⁡
                γ
                ,
              
            
            
              
                
                  a
                  
                    2
                  
                
              
              
                
                =
                
                  b
                  
                    2
                  
                
                +
                
                  c
                  
                    2
                  
                
                −
                2
                b
                c
                cos
                ⁡
                α
                ,
              
            
            
              
                
                  b
                  
                    2
                  
                
              
              
                
                =
                
                  a
                  
                    2
                  
                
                +
                
                  c
                  
                    2
                  
                
                −
                2
                a
                c
                cos
                ⁡
                β
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}c^{2}&=a^{2}+b^{2}-2ab\cos \gamma ,\\[3mu]a^{2}&=b^{2}+c^{2}-2bc\cos \alpha ,\\[3mu]b^{2}&=a^{2}+c^{2}-2ac\cos \beta .\end{aligned}}}
  The law of cosines generalizes the Pythagorean theorem, which holds only for right triangles: if 
  
    
      
        γ
      
    
    {\displaystyle \gamma }
   is a right angle then 
  
    
      
        cos
        ⁡
        γ
        =
        0
        ,
      
    
    {\displaystyle \cos \gamma =0,}
   and the law of cosines reduces to 
  
    
      
        
          c
          
            2
          
        
        =
        
          a
          
            2
          
        
        +
        
          b
          
            2
          
        
        .
      
    
    {\displaystyle c^{2}=a^{2}+b^{2}.}
  
The law of cosines is useful for solving a triangle when all three sides or two sides and their included angle are given.


== Use in solving triangles ==
The theorem is used in solution of triangles, i.e., to find (see Figure 3):

the third side of a triangle if one knows two sides and the angle between them: 
the angles of a triangle if one knows the three sides: 
the third side of a triangle if one knows two sides and an angle opposite to one of them (this side can also be found by two applications of the law of sines):
These formulas produce high round-off errors in floating point calculations if the triangle is very acute, i.e., if c is small relative to a and b or γ is small compared to 1. It is even possible to obtain a result slightly greater than one for the cosine of an angle.
The third formula shown is the result of solving for a in the quadratic equation a2 − 2ab cos γ + b2 − c2 = 0. This equation can have 2, 1, or 0 positive solutions corresponding to the number of possible triangles given the data. It will have two positive solutions if b sin γ < c < b, only one positive solution if c = b sin γ, and no solution if c < b sin γ. These different cases are also explained by the side-side-angle congruence ambiguity.


== History ==
Book II of Euclid's Elements, compiled c. 300 BC from material up to a century or two older, contains a geometric theorem corresponding to the law of cosines but expressed in the contemporary language of rectangle areas; Hellenistic trigonometry developed later, and sine and cosine per se first appeared centuries afterward in India.
The cases of obtuse triangles and acute triangles (corresponding to the two cases of negative or positive cosine) are treated separately, in Propositions II.12 and II.13:
Proposition 12.In obtuse-angled triangles the square on the side subtending the obtuse angle is greater than the squares on the sides containing the obtuse angle by twice the rectangle contained by one of the sides about the obtuse angle, namely that on which the perpendicular falls, and the straight line cut off outside by the perpendicular towards the obtuse angle.
Proposition 13 contains an analogous statement for acute triangles. In his (now-lost and only preserved through fragmentary quotations) commentary, Heron of Alexandria provided proofs of the converses of both II.12 and II.13.
Using notation as in Fig. 2, Euclid's statement of proposition II.12 can be represented more concisely (though anachronistically) by the formula

  
    
      
        A
        
          B
          
            2
          
        
        =
        C
        
          A
          
            2
          
        
        +
        C
        
          B
          
            2
          
        
        +
        2
        (
        C
        A
        )
        (
        C
        H
        )
        .
      
    
    {\displaystyle AB^{2}=CA^{2}+CB^{2}+2(CA)(CH).}
  To transform this into the familiar expression for the law of cosines, substitute 
  
    
      
        A
        B
        =
        c
        ,
      
    
    {\displaystyle AB=c,}
   
  
    
      
        C
        A
        =
        b
        ,
      
    
    {\displaystyle CA=b,}
   
  
    
      
        C
        B
        =
        a
        ,
      
    
    {\displaystyle CB=a,}
   and 
  
    
      
        C
        H
        =
        a
        cos
        ⁡
        (
        π
        −
        γ
        )
         
      
    
    {\displaystyle CH=a\cos(\pi -\gamma )\ }
  
  
    
      
        =
        −
        a
        cos
        ⁡
        γ
        .
      
    
    {\displaystyle =-a\cos \gamma .}
  
Proposition II.13 was not used in Euclid's time for the solution of triangles, but later it was used that way in the course of solving astronomical problems by al-Bīrūnī (11th century) and Johannes de Muris (14th century). Something equivalent to the spherical law of cosines was used (but not stated in general) by al-Khwārizmī (9th century), al-Battānī (9th century), and Nīlakaṇṭha (15th century).Jamshīd al-Kāshī, a 15th century Persian mathematician and astronomer who computed the most accurate trigonometric tables of his era, wrote about the solution of triangles in his Miftāḥ al-ḥisāb (Key of Arithmetic, 1427), including the following method for finding the third side given two sides and their included angle:
Another case is when two sides and the angle between them are known and the rest are unknown. We multiply one of the sides by the sine of the [known] angle one time and by the sine of its complement the other time converted and we subtract the second result from the other side if the angle is acute and add it if the angle is obtuse. We then square the result and add to it the square of the first result. We take the square root of the sum to get the remaining side....
Using modern algebraic notation and conventions this might be written

  
    
      
        c
        =
        
          
            (
            b
            −
            a
            cos
            ⁡
            γ
            
              )
              
                2
              
            
            +
            (
            a
            sin
            ⁡
            γ
            
              )
              
                2
              
            
          
        
      
    
    {\displaystyle c={\sqrt {(b-a\cos \gamma )^{2}+(a\sin \gamma )^{2}}}}
  when 
  
    
      
        γ
      
    
    {\displaystyle \gamma }
   is acute or

  
    
      
        c
        =
        
          
            
              
                (
                
                  b
                  +
                  a
                  
                    |
                    
                      cos
                      ⁡
                      γ
                    
                    |
                  
                
                )
              
              
                2
              
            
            +
            
              
                (
                
                  a
                  sin
                  ⁡
                  γ
                
                )
              
              
                2
              
            
          
        
      
    
    {\displaystyle c={\sqrt {\left(b+a\left|\cos \gamma \right|\right)^{2}+\left(a\sin \gamma \right)^{2}}}}
  when 
  
    
      
        γ
      
    
    {\displaystyle \gamma }
   is obtuse (when 
  
    
      
        γ
      
    
    {\displaystyle \gamma }
   is obtuse, the modern convention is that 
  
    
      
        cos
        ⁡
        γ
      
    
    {\displaystyle \cos \gamma }
   is negative and 
  
    
      
        cos
        ⁡
        (
        π
        −
        γ
        )
        =
        −
        cos
        ⁡
        γ
      
    
    {\displaystyle \cos(\pi -\gamma )=-\cos \gamma }
   is positive; historically sines and cosines were considered to be line segments with non-negative lengths). By squaring both sides, expanding the squared binomial, and then applying the Pythagorean trigonometric identity 
  
    
      
        
          cos
          
            2
          
        
        ⁡
        γ
        +
        
          sin
          
            2
          
        
        ⁡
        γ
        =
        1
        ,
      
    
    {\displaystyle \cos ^{2}\gamma +\sin ^{2}\gamma =1,}
   we obtain the familiar law of cosines:

  
    
      
        
          
            
              
                
                  c
                  
                    2
                  
                
              
              
                
                =
                
                  b
                  
                    2
                  
                
                −
                2
                b
                a
                cos
                ⁡
                γ
                +
                
                  a
                  
                    2
                  
                
                
                  cos
                  
                    2
                  
                
                ⁡
                γ
                +
                
                  a
                  
                    2
                  
                
                
                  sin
                  
                    2
                  
                
                ⁡
                γ
              
            
            
              
              
                
                =
                
                  a
                  
                    2
                  
                
                +
                
                  b
                  
                    2
                  
                
                −
                2
                a
                b
                cos
                ⁡
                γ
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}c^{2}&=b^{2}-2ba\cos \gamma +a^{2}\cos ^{2}\gamma +a^{2}\sin ^{2}\gamma \\[5mu]&=a^{2}+b^{2}-2ab\cos \gamma .\end{aligned}}}
  In France, the law of cosines is sometimes referred to as the théorème d'Al-Kashi.Al-Kāshī's method is essentially the same as the method recommended for solving such triangles by Naṣīr al-Dīn al-Ṭūsī's Kitāb al-Shakl al-qattāʴ (Book on the Complete Quadrilateral, c. 1250), but with the steps described explicitly instead of leaving the details to the reader.The theorem was first written using algebraic notation by François Viète in the 16th century. At the beginning of the 19th century, modern algebraic notation allowed the law of cosines to be written in its current symbolic form.


== Proofs ==


=== Using Cartesian coordinates ===
Consider a triangle with sides of length a, b, c, where θ is the measurement of the angle opposite the side of length c. This triangle can be placed on the Cartesian coordinate system with side a aligned along the x axis and angle θ placed at the origin, by plotting the components of the 3 points of the triangle as shown in Fig. 4:

  
    
      
        A
        =
        (
        b
        cos
        ⁡
        θ
        ,
        b
        sin
        ⁡
        θ
        )
        ,
        B
        =
        (
        a
        ,
        0
        )
        ,
        
           and 
        
        C
        =
        (
        0
        ,
        0
        )
        .
      
    
    {\displaystyle A=(b\cos \theta ,b\sin \theta ),B=(a,0),{\text{ and }}C=(0,0).}
  By the distance formula, 

  
    
      
        c
        =
        
          
            (
            a
            −
            b
            cos
            ⁡
            θ
            
              )
              
                2
              
            
            +
            (
            0
            −
            b
            sin
            ⁡
            θ
            
              )
              
                2
              
            
          
        
        .
      
    
    {\displaystyle c={\sqrt {(a-b\cos \theta )^{2}+(0-b\sin \theta )^{2}}}.}
  Squaring both sides and simplifying 

  
    
      
        
          
            
              
                
                  c
                  
                    2
                  
                
              
              
                
                =
                (
                a
                −
                b
                cos
                ⁡
                θ
                
                  )
                  
                    2
                  
                
                +
                (
                −
                b
                sin
                ⁡
                θ
                
                  )
                  
                    2
                  
                
              
            
            
              
              
                
                =
                
                  a
                  
                    2
                  
                
                −
                2
                a
                b
                cos
                ⁡
                θ
                +
                
                  b
                  
                    2
                  
                
                
                  cos
                  
                    2
                  
                
                ⁡
                θ
                +
                
                  b
                  
                    2
                  
                
                
                  sin
                  
                    2
                  
                
                ⁡
                θ
              
            
            
              
              
                
                =
                
                  a
                  
                    2
                  
                
                +
                
                  b
                  
                    2
                  
                
                (
                
                  sin
                  
                    2
                  
                
                ⁡
                θ
                +
                
                  cos
                  
                    2
                  
                
                ⁡
                θ
                )
                −
                2
                a
                b
                cos
                ⁡
                θ
              
            
            
              
              
                
                =
                
                  a
                  
                    2
                  
                
                +
                
                  b
                  
                    2
                  
                
                −
                2
                a
                b
                cos
                ⁡
                θ
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}c^{2}&=(a-b\cos \theta )^{2}+(-b\sin \theta )^{2}\\&=a^{2}-2ab\cos \theta +b^{2}\cos ^{2}\theta +b^{2}\sin ^{2}\theta \\&=a^{2}+b^{2}(\sin ^{2}\theta +\cos ^{2}\theta )-2ab\cos \theta \\&=a^{2}+b^{2}-2ab\cos \theta .\end{aligned}}}
  An advantage of this proof is that it does not require the consideration of different cases for when the triangle is acute, right, or obtuse.


=== Using trigonometry ===
Dropping the perpendicular onto the side c through point C, an altitude of the triangle, shows (see Fig. 5)

  
    
      
        c
        =
        a
        cos
        ⁡
        β
        +
        b
        cos
        ⁡
        α
        .
      
    
    {\displaystyle c=a\cos \beta +b\cos \alpha .}
  (This is still true if α or β is obtuse, in which case the perpendicular falls outside the triangle.)  Multiplying through by c yields

  
    
      
        
          c
          
            2
          
        
        =
        a
        c
        cos
        ⁡
        β
        +
        b
        c
        cos
        ⁡
        α
        .
      
    
    {\displaystyle c^{2}=ac\cos \beta +bc\cos \alpha .}
  Considering the two other altitudes of the triangle yields

  
    
      
        
          
            
              
                
                  a
                  
                    2
                  
                
              
              
                
                =
                a
                c
                cos
                ⁡
                β
                +
                a
                b
                cos
                ⁡
                γ
                ,
              
            
            
              
                
                  b
                  
                    2
                  
                
              
              
                
                =
                b
                c
                cos
                ⁡
                α
                +
                a
                b
                cos
                ⁡
                γ
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}a^{2}&=ac\cos \beta +ab\cos \gamma ,\\[3mu]b^{2}&=bc\cos \alpha +ab\cos \gamma .\end{aligned}}}
  Adding the latter two equations gives

  
    
      
        
          a
          
            2
          
        
        +
        
          b
          
            2
          
        
        =
        a
        c
        cos
        ⁡
        β
        +
        b
        c
        cos
        ⁡
        α
        +
        2
        a
        b
        cos
        ⁡
        γ
        .
      
    
    {\displaystyle a^{2}+b^{2}=ac\cos \beta +bc\cos \alpha +2ab\cos \gamma .}
  Substituting the first equation into the last one results in

  
    
      
        
          a
          
            2
          
        
        +
        
          b
          
            2
          
        
        =
        
          c
          
            2
          
        
        +
        2
        a
        b
        cos
        ⁡
        γ
      
    
    {\displaystyle a^{2}+b^{2}=c^{2}+2ab\cos \gamma }
  which is equivalent to

  
    
      
        
          c
          
            2
          
        
        =
        
          a
          
            2
          
        
        +
        
          b
          
            2
          
        
        −
        2
        a
        b
        cos
        ⁡
        γ
        .
      
    
    {\displaystyle c^{2}=a^{2}+b^{2}-2ab\cos \gamma .}
  This proof uses trigonometry in that it treats the cosines of the various angles as quantities in their own right. It uses the fact that the cosine of an angle expresses the relation between the two sides enclosing that angle in any right triangle. Other proofs (below) are more geometric in that they treat an expression such as a cos γ merely as a label for the length of a certain line segment.
Many proofs deal with the cases of obtuse and acute angles γ separately.


=== Using the Pythagorean theorem ===


==== Case of an obtuse angle ====
Euclid proved this theorem by applying the Pythagorean theorem to each of the two right triangles in Fig. 2 (AHB and CHB). Using d to denote the line segment CH and h for the height BH, triangle AHB gives us

  
    
      
        
          c
          
            2
          
        
        =
        (
        b
        +
        d
        
          )
          
            2
          
        
        +
        
          h
          
            2
          
        
        ,
      
    
    {\displaystyle c^{2}=(b+d)^{2}+h^{2},}
  and triangle CHB gives

  
    
      
        
          d
          
            2
          
        
        +
        
          h
          
            2
          
        
        =
        
          a
          
            2
          
        
        .
      
    
    {\displaystyle d^{2}+h^{2}=a^{2}.}
  Expanding the first equation gives

  
    
      
        
          c
          
            2
          
        
        =
        
          b
          
            2
          
        
        +
        2
        b
        d
        +
        
          d
          
            2
          
        
        +
        
          h
          
            2
          
        
        .
      
    
    {\displaystyle c^{2}=b^{2}+2bd+d^{2}+h^{2}.}
  Substituting the second equation into this, the following can be obtained:

  
    
      
        
          c
          
            2
          
        
        =
        
          a
          
            2
          
        
        +
        
          b
          
            2
          
        
        +
        2
        b
        d
        .
      
    
    {\displaystyle c^{2}=a^{2}+b^{2}+2bd.}
  This is Euclid's Proposition 12 from Book 2 of the Elements. To transform it into the modern form of the law of cosines, note that

  
    
      
        d
        =
        a
        cos
        ⁡
        (
        π
        −
        γ
        )
        =
        −
        a
        cos
        ⁡
        γ
        .
      
    
    {\displaystyle d=a\cos(\pi -\gamma )=-a\cos \gamma .}
  


==== Case of an acute angle ====
Euclid's proof of his Proposition 13 proceeds along the same lines as his proof of Proposition 12: he applies the Pythagorean theorem to both right triangles formed by dropping the perpendicular onto one of the sides enclosing the angle γ and uses the square of a difference to simplify.


==== Another proof in the acute case ====
Using more trigonometry, the law of cosines can be deduced by using the Pythagorean theorem only once. In fact, by using the right triangle on the left hand side of Fig. 6 it can be shown that:

  
    
      
        
          
            
              
                
                  c
                  
                    2
                  
                
              
              
                
                =
                (
                b
                −
                a
                cos
                ⁡
                γ
                
                  )
                  
                    2
                  
                
                +
                (
                a
                sin
                ⁡
                γ
                
                  )
                  
                    2
                  
                
              
            
            
              
              
                
                =
                
                  b
                  
                    2
                  
                
                −
                2
                a
                b
                cos
                ⁡
                γ
                +
                
                  a
                  
                    2
                  
                
                
                  cos
                  
                    2
                  
                
                ⁡
                γ
                +
                
                  a
                  
                    2
                  
                
                
                  sin
                  
                    2
                  
                
                ⁡
                γ
              
            
            
              
              
                
                =
                
                  b
                  
                    2
                  
                
                +
                
                  a
                  
                    2
                  
                
                −
                2
                a
                b
                cos
                ⁡
                γ
                ,
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}c^{2}&=(b-a\cos \gamma )^{2}+(a\sin \gamma )^{2}\\&=b^{2}-2ab\cos \gamma +a^{2}\cos ^{2}\gamma +a^{2}\sin ^{2}\gamma \\&=b^{2}+a^{2}-2ab\cos \gamma ,\end{aligned}}}
  using the trigonometric identity 
  
    
      
        
          cos
          
            2
          
        
        ⁡
        γ
        +
        
          sin
          
            2
          
        
        ⁡
        γ
        =
        1.
      
    
    {\displaystyle \cos ^{2}\gamma +\sin ^{2}\gamma =1.}
  
This proof needs a slight modification if b < a cos(γ). In this case, the right triangle to which the Pythagorean theorem is applied moves outside the triangle ABC. The only effect this has on the calculation is that the quantity b − a cos(γ) is replaced by a cos(γ) − b. As this quantity enters the calculation only through its square, the rest of the proof is unaffected. However, this problem only occurs when β is obtuse, and may be avoided by reflecting the triangle about the bisector of γ.
Referring to Fig. 6 it is worth noting that if the angle opposite side a is α then:

  
    
      
        tan
        ⁡
        α
        =
        
          
            
              a
              sin
              ⁡
              γ
            
            
              b
              −
              a
              cos
              ⁡
              γ
            
          
        
        .
      
    
    {\displaystyle \tan \alpha ={\frac {a\sin \gamma }{b-a\cos \gamma }}.}
  This is useful for direct calculation of a second angle when two sides and an included angle are given.


=== Using Ptolemy's theorem ===
Referring to the diagram, triangle ABC with sides AB = c, BC = a and AC = b is drawn inside its circumcircle as shown. Triangle ABD is constructed congruent to triangle ABC with AD = BC and BD = AC. Perpendiculars from D and C meet base AB at E and F respectively. Then:

  
    
      
        
          
            
              
              
                B
                F
                =
                A
                E
                =
                B
                C
                cos
                ⁡
                
                  
                    
                      B
                      ^
                    
                  
                
                =
                a
                cos
                ⁡
                
                  
                    
                      B
                      ^
                    
                  
                
              
            
            
              
                ⇒
                 
              
              
                D
                C
                =
                E
                F
                =
                A
                B
                −
                2
                B
                F
                =
                c
                −
                2
                a
                cos
                ⁡
                
                  
                    
                      B
                      ^
                    
                  
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}&BF=AE=BC\cos {\hat {B}}=a\cos {\hat {B}}\\\Rightarrow \ &DC=EF=AB-2BF=c-2a\cos {\hat {B}}.\end{aligned}}}
  Now the law of cosines is rendered by a straightforward application of Ptolemy's theorem to cyclic quadrilateral ABCD:

  
    
      
        
          
            
              
              
                A
                D
                ×
                B
                C
                +
                A
                B
                ×
                D
                C
                =
                A
                C
                ×
                B
                D
              
            
            
              
                ⇒
                 
              
              
                
                  a
                  
                    2
                  
                
                +
                c
                (
                c
                −
                2
                a
                cos
                ⁡
                
                  
                    
                      B
                      ^
                    
                  
                
                )
                =
                
                  b
                  
                    2
                  
                
              
            
            
              
                ⇒
                 
              
              
                
                  a
                  
                    2
                  
                
                +
                
                  c
                  
                    2
                  
                
                −
                2
                a
                c
                cos
                ⁡
                
                  
                    
                      B
                      ^
                    
                  
                
                =
                
                  b
                  
                    2
                  
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}&AD\times BC+AB\times DC=AC\times BD\\\Rightarrow \ &a^{2}+c(c-2a\cos {\hat {B}})=b^{2}\\\Rightarrow \ &a^{2}+c^{2}-2ac\cos {\hat {B}}=b^{2}.\end{aligned}}}
  Plainly if angle B is right, then ABCD is a rectangle and application of Ptolemy's theorem yields the Pythagorean theorem:

  
    
      
        
          a
          
            2
          
        
        +
        
          c
          
            2
          
        
        =
        
          b
          
            2
          
        
        .
        
      
    
    {\displaystyle a^{2}+c^{2}=b^{2}.\quad }
  


=== By comparing areas ===
One can also prove the law of cosines by calculating areas. The change of sign as the angle γ becomes obtuse makes a case distinction necessary.
Recall that

a2, b2, and c2 are the areas of the squares with sides a, b, and c, respectively;
if γ is acute, then ab cos γ is the area of the parallelogram with sides a and b forming an angle of γ′ = π/2 − γ;
if γ is obtuse, and so cos γ is negative, then −ab cos γ is the area of the parallelogram with sides a and b forming an angle of γ′ = γ − π/2.Acute case. Figure 7a shows a heptagon cut into smaller pieces (in two different ways) to yield a proof of the law of cosines. The various pieces are

in pink, the areas a2, b2 on the left and the areas 2ab cos γ and c2 on the right;
in blue, the triangle ABC, on the left and on the right;
in grey, auxiliary triangles, all congruent to ABC, an equal number (namely 2) both on the left and on the right.The equality of areas on the left and on the right gives

  
    
      
        
        
          a
          
            2
          
        
        +
        
          b
          
            2
          
        
        =
        
          c
          
            2
          
        
        +
        2
        a
        b
        cos
        ⁡
        γ
        
        .
      
    
    {\displaystyle \,a^{2}+b^{2}=c^{2}+2ab\cos \gamma \,.}
  Obtuse case. Figure 7b cuts a hexagon in two different ways into smaller pieces, yielding a proof of the law of cosines in the case that the angle γ is obtuse. We have

in pink, the areas a2, b2, and −2ab cos γ on the left and c2 on the right;
in blue, the triangle ABC twice, on the left, as well as on the right.The equality of areas on the left and on the right gives

  
    
      
        
        
          a
          
            2
          
        
        +
        
          b
          
            2
          
        
        −
        2
        a
        b
        cos
        ⁡
        (
        γ
        )
        =
        
          c
          
            2
          
        
        .
      
    
    {\displaystyle \,a^{2}+b^{2}-2ab\cos(\gamma )=c^{2}.}
  The rigorous proof will have to include proofs that various shapes are congruent and therefore have equal area. This will use the theory of congruent triangles.


=== Using circle geometry ===
Using the geometry of the circle, it is possible to give a more geometric proof than using the Pythagorean theorem alone. Algebraic manipulations (in particular the binomial theorem) are avoided.
Case of acute angle γ, where a > 2b cos γ. Drop the perpendicular from A onto a = BC, creating a line segment of length b cos γ. Duplicate the right triangle to form the isosceles triangle ACP. Construct the circle with center A and radius b, and its tangent h = BH through B. The tangent h forms a right angle with the radius b (Euclid's Elements: Book 3, Proposition 18; or see here), so the yellow triangle in Figure 8 is right. Apply  the Pythagorean theorem to obtain

  
    
      
        
          c
          
            2
          
        
        =
        
          b
          
            2
          
        
        +
        
          h
          
            2
          
        
        .
      
    
    {\displaystyle c^{2}=b^{2}+h^{2}.}
  Then use the tangent secant theorem (Euclid's Elements: Book 3, Proposition 36), which says that the square on the tangent through a point B outside the circle is equal to the product of the two lines segments (from B) created by any secant of the circle through B. In the present case: BH2 = BC·BP, or

  
    
      
        
          h
          
            2
          
        
        =
        a
        (
        a
        −
        2
        b
        cos
        ⁡
        γ
        )
        .
      
    
    {\displaystyle h^{2}=a(a-2b\cos \gamma ).}
  Substituting into the previous equation gives the law of cosines:

  
    
      
        
          c
          
            2
          
        
        =
        
          b
          
            2
          
        
        +
        a
        (
        a
        −
        2
        b
        cos
        ⁡
        γ
        )
        .
      
    
    {\displaystyle c^{2}=b^{2}+a(a-2b\cos \gamma ).}
  Note that h2 is the power of the point B with respect to the circle. The use of the Pythagorean theorem and the tangent secant theorem can be replaced by a single application of the power of a point theorem.
Case of acute angle γ, where a < 2b cos γ. Drop the perpendicular from A onto a = BC, creating a line segment of length b cos γ. Duplicate the right triangle to form the isosceles triangle ACP. Construct the circle with center A and radius b, and a chord through B perpendicular to c = AB, half of which is h = BH. Apply  the Pythagorean theorem to obtain

  
    
      
        
          b
          
            2
          
        
        =
        
          c
          
            2
          
        
        +
        
          h
          
            2
          
        
        .
      
    
    {\displaystyle b^{2}=c^{2}+h^{2}.}
  Now use the chord theorem (Euclid's Elements: Book 3, Proposition 35), which says that if two chords intersect, the product of the two line segments obtained on one chord is equal to the product of the two line segments obtained on the other chord. In the present case: BH2 = BC·BP, or

  
    
      
        
          h
          
            2
          
        
        =
        a
        (
        2
        b
        cos
        ⁡
        γ
        −
        a
        )
        .
      
    
    {\displaystyle h^{2}=a(2b\cos \gamma -a).}
  Substituting into the previous equation gives the law of cosines:

  
    
      
        
          b
          
            2
          
        
        =
        
          c
          
            2
          
        
        +
        a
        (
        2
        b
        cos
        ⁡
        γ
        −
        a
        )
        
        .
      
    
    {\displaystyle b^{2}=c^{2}+a(2b\cos \gamma -a)\,.}
  Note that the power of the point B with respect to the circle has the negative value −h2.
Case of obtuse angle γ. This proof uses the power of a point theorem directly, without the auxiliary triangles obtained by constructing a tangent or a chord. Construct a circle with center B and radius a (see Figure 9), which intersects the secant through A and C in C and K. The power of the point A with respect to the circle is equal to both AB2 − BC2 and AC·AK. Therefore,

  
    
      
        
          
            
              
                
                  c
                  
                    2
                  
                
                −
                
                  a
                  
                    2
                  
                
              
              
                
                

                
                =
                b
                (
                b
                +
                2
                a
                cos
                ⁡
                (
                π
                −
                γ
                )
                )
              
            
            
              
              
                
                

                
                =
                b
                (
                b
                −
                2
                a
                cos
                ⁡
                γ
                )
                ,
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}c^{2}-a^{2}&{}=b(b+2a\cos(\pi -\gamma ))\\&{}=b(b-2a\cos \gamma ),\end{aligned}}}
  which is the law of cosines.
Using algebraic measures for line segments (allowing negative numbers as lengths of segments) the case of obtuse angle (CK > 0) and acute angle (CK < 0) can be treated simultaneously.


=== Using the law of sines ===
By using the law of sines and knowing that the angles of a triangle must sum to 180 degrees, we have the following system of equations (the three unknowns are the angles):

  
    
      
        
          
            c
            
              sin
              ⁡
              γ
            
          
        
        =
        
          
            b
            
              sin
              ⁡
              β
            
          
        
        ,
      
    
    {\displaystyle {\frac {c}{\sin \gamma }}={\frac {b}{\sin \beta }},}
  

  
    
      
        
          
            c
            
              sin
              ⁡
              γ
            
          
        
        =
        
          
            a
            
              sin
              ⁡
              α
            
          
        
        ,
      
    
    {\displaystyle {\frac {c}{\sin \gamma }}={\frac {a}{\sin \alpha }},}
  

  
    
      
        α
        +
        β
        +
        γ
        =
        π
        .
      
    
    {\displaystyle \alpha +\beta +\gamma =\pi .}
  Then, by using the third equation of the system, we obtain a system of two equations in two variables:

  
    
      
        
          
            c
            
              sin
              ⁡
              γ
            
          
        
        =
        
          
            b
            
              sin
              ⁡
              (
              α
              +
              γ
              )
            
          
        
        ,
      
    
    {\displaystyle {\frac {c}{\sin \gamma }}={\frac {b}{\sin(\alpha +\gamma )}},}
  

  
    
      
        
          
            c
            
              sin
              ⁡
              γ
            
          
        
        =
        
          
            a
            
              sin
              ⁡
              α
            
          
        
        ,
      
    
    {\displaystyle {\frac {c}{\sin \gamma }}={\frac {a}{\sin \alpha }},}
  where we have used the trigonometric property that the sine of a supplementary angle is equal to the sine of the angle.
Using the identity (see Angle sum and difference identities)

  
    
      
        sin
        ⁡
        (
        α
        +
        γ
        )
        =
        sin
        ⁡
        α
        cos
        ⁡
        γ
        +
        sin
        ⁡
        γ
        cos
        ⁡
        α
      
    
    {\displaystyle \sin(\alpha +\gamma )=\sin \alpha \cos \gamma +\sin \gamma \cos \alpha }
  leads to

  
    
      
        c
        (
        sin
        ⁡
        α
        cos
        ⁡
        γ
        +
        sin
        ⁡
        γ
        cos
        ⁡
        α
        )
        =
        b
        sin
        ⁡
        γ
        ,
      
    
    {\displaystyle c(\sin \alpha \cos \gamma +\sin \gamma \cos \alpha )=b\sin \gamma ,}
  

  
    
      
        c
        sin
        ⁡
        α
        =
        a
        sin
        ⁡
        γ
        .
      
    
    {\displaystyle c\sin \alpha =a\sin \gamma .}
  By dividing the whole system by cos γ, we have:

  
    
      
        c
        (
        sin
        ⁡
        α
        +
        tan
        ⁡
        γ
        cos
        ⁡
        α
        )
        =
        b
        tan
        ⁡
        γ
        ,
      
    
    {\displaystyle c(\sin \alpha +\tan \gamma \cos \alpha )=b\tan \gamma ,}
  

  
    
      
        
          
            
              c
              sin
              ⁡
              α
            
            
              cos
              ⁡
              γ
            
          
        
        =
        a
        tan
        ⁡
        γ
        ,
      
    
    {\displaystyle {\frac {c\sin \alpha }{\cos \gamma }}=a\tan \gamma ,}
  

  
    
      
        
          
            
              
                c
                
                  2
                
              
              
                sin
                
                  2
                
              
              ⁡
              α
            
            
              
                cos
                
                  2
                
              
              ⁡
              γ
            
          
        
        =
        
          a
          
            2
          
        
        
          tan
          
            2
          
        
        ⁡
        γ
        .
      
    
    {\displaystyle {\frac {c^{2}\sin ^{2}\alpha }{\cos ^{2}\gamma }}=a^{2}\tan ^{2}\gamma .}
  Hence, from the first equation of the system, we can obtain

  
    
      
        
          
            
              c
              sin
              ⁡
              α
            
            
              b
              −
              c
              cos
              ⁡
              α
            
          
        
        =
        tan
        ⁡
        γ
      
    
    {\displaystyle {\frac {c\sin \alpha }{b-c\cos \alpha }}=\tan \gamma }
  By substituting this expression into the second equation and by using 

  
    
      
        1
        +
        
          tan
          
            2
          
        
        ⁡
        γ
        =
        
          
            1
            
              
                cos
                
                  2
                
              
              ⁡
              γ
            
          
        
      
    
    {\displaystyle 1+\tan ^{2}\gamma ={\frac {1}{\cos ^{2}\gamma }}}
  we can obtain one equation with one variable:

  
    
      
        
          c
          
            2
          
        
        
          sin
          
            2
          
        
        ⁡
        α
        
          [
          
            1
            +
            
              
                
                  
                    c
                    
                      2
                    
                  
                  
                    sin
                    
                      2
                    
                  
                  ⁡
                  α
                
                
                  (
                  b
                  −
                  c
                  cos
                  ⁡
                  α
                  
                    )
                    
                      2
                    
                  
                
              
            
          
          ]
        
        =
        
          a
          
            2
          
        
        ⋅
        
          
            
              
                c
                
                  2
                
              
              
                sin
                
                  2
                
              
              ⁡
              α
            
            
              (
              b
              −
              c
              cos
              ⁡
              α
              
                )
                
                  2
                
              
            
          
        
      
    
    {\displaystyle c^{2}\sin ^{2}\alpha \left[1+{\frac {c^{2}\sin ^{2}\alpha }{(b-c\cos \alpha )^{2}}}\right]=a^{2}\cdot {\frac {c^{2}\sin ^{2}\alpha }{(b-c\cos \alpha )^{2}}}}
  By multiplying by (b − c cos α)2, we can obtain the following equation:

  
    
      
        (
        b
        −
        c
        cos
        ⁡
        α
        
          )
          
            2
          
        
        +
        
          c
          
            2
          
        
        
          sin
          
            2
          
        
        ⁡
        α
        =
        
          a
          
            2
          
        
        .
      
    
    {\displaystyle (b-c\cos \alpha )^{2}+c^{2}\sin ^{2}\alpha =a^{2}.}
  This implies

  
    
      
        
          b
          
            2
          
        
        −
        2
        b
        c
        cos
        ⁡
        α
        +
        
          c
          
            2
          
        
        
          cos
          
            2
          
        
        ⁡
        α
        +
        
          c
          
            2
          
        
        
          sin
          
            2
          
        
        ⁡
        α
        =
        
          a
          
            2
          
        
        .
      
    
    {\displaystyle b^{2}-2bc\cos \alpha +c^{2}\cos ^{2}\alpha +c^{2}\sin ^{2}\alpha =a^{2}.}
  Recalling the Pythagorean identity, we obtain the law of cosines:

  
    
      
        
          a
          
            2
          
        
        =
        
          b
          
            2
          
        
        +
        
          c
          
            2
          
        
        −
        2
        b
        c
        cos
        ⁡
        α
        .
      
    
    {\displaystyle a^{2}=b^{2}+c^{2}-2bc\cos \alpha .}
  


=== Using vectors ===
Denote

  
    
      
        
          
            
              C
              B
            
            →
          
        
        =
        
          
            
              a
              →
            
          
        
        ,
         
        
          
            
              C
              A
            
            →
          
        
        =
        
          
            
              b
              →
            
          
        
        ,
         
        
          
            
              A
              B
            
            →
          
        
        =
        
          
            
              c
              →
            
          
        
      
    
    {\displaystyle {\overrightarrow {CB}}={\vec {a}},\ {\overrightarrow {CA}}={\vec {b}},\ {\overrightarrow {AB}}={\vec {c}}}
  Therefore,

  
    
      
        
          
            
              c
              →
            
          
        
        =
        
          
            
              a
              →
            
          
        
        −
        
          
            
              b
              →
            
          
        
      
    
    {\displaystyle {\vec {c}}={\vec {a}}-{\vec {b}}}
  Taking the dot product of each side with itself:

  
    
      
        
          
            
              c
              →
            
          
        
        ⋅
        
          
            
              c
              →
            
          
        
        =
        (
        
          
            
              a
              →
            
          
        
        −
        
          
            
              b
              →
            
          
        
        )
        ⋅
        (
        
          
            
              a
              →
            
          
        
        −
        
          
            
              b
              →
            
          
        
        )
      
    
    {\displaystyle {\vec {c}}\cdot {\vec {c}}=({\vec {a}}-{\vec {b}})\cdot ({\vec {a}}-{\vec {b}})}
  

  
    
      
        ‖
        
          
            
              c
              →
            
          
        
        
          ‖
          
            2
          
        
        =
        ‖
        
          
            
              a
              →
            
          
        
        
          ‖
          
            2
          
        
        +
        ‖
        
          
            
              b
              →
            
          
        
        
          ‖
          
            2
          
        
        −
        2
        
        
          
            
              a
              →
            
          
        
        ⋅
        
          
            
              b
              →
            
          
        
      
    
    {\displaystyle \Vert {\vec {c}}\Vert ^{2}=\Vert {\vec {a}}\Vert ^{2}+\Vert {\vec {b}}\Vert ^{2}-2\,{\vec {a}}\cdot {\vec {b}}}
  Using the identity

  
    
      
        
          
            
              u
              →
            
          
        
        ⋅
        
          
            
              v
              →
            
          
        
        =
        ‖
        
          
            
              u
              →
            
          
        
        ‖
        
        ‖
        
          
            
              v
              →
            
          
        
        ‖
        cos
        ⁡
        ∠
        (
        
          
            
              u
              →
            
          
        
        ,
         
        
          
            
              v
              →
            
          
        
        )
      
    
    {\displaystyle {\vec {u}}\cdot {\vec {v}}=\Vert {\vec {u}}\Vert \,\Vert {\vec {v}}\Vert \cos \angle ({\vec {u}},\ {\vec {v}})}
  leads to

  
    
      
        ‖
        
          
            
              c
              →
            
          
        
        
          ‖
          
            2
          
        
        =
        ‖
        
          
            
              a
              →
            
          
        
        
          ‖
          
            2
          
        
        +
        
          
            ‖
            
              
                
                  b
                  →
                
              
            
            ‖
          
          
            2
          
        
        −
        2
        
        ‖
        
          
            
              a
              →
            
          
        
        ‖
        
        
        ‖
        
          
            
              b
              →
            
          
        
        ‖
        cos
        ⁡
        ∠
        (
        
          
            
              a
              →
            
          
        
        ,
         
        
          
            
              b
              →
            
          
        
        )
      
    
    {\displaystyle \Vert {\vec {c}}\Vert ^{2}=\Vert {\vec {a}}\Vert ^{2}+{\Vert {\vec {b}}\Vert }^{2}-2\,\Vert {\vec {a}}\Vert \!\;\Vert {\vec {b}}\Vert \cos \angle ({\vec {a}},\ {\vec {b}})}
  The result follows.


== Isosceles case ==
When a = b, i.e., when the triangle is isosceles with the two sides incident to the angle γ equal, the law of cosines simplifies significantly. Namely, because a2 + b2 = 2a2 = 2ab, the law of cosines becomes

  
    
      
        cos
        ⁡
        γ
        =
        1
        −
        
          
            
              c
              
                2
              
            
            
              2
              
                a
                
                  2
                
              
            
          
        
      
    
    {\displaystyle \cos \gamma =1-{\frac {c^{2}}{2a^{2}}}}
  or

  
    
      
        
          c
          
            2
          
        
        =
        2
        
          a
          
            2
          
        
        (
        1
        −
        cos
        ⁡
        γ
        )
        .
      
    
    {\displaystyle c^{2}=2a^{2}(1-\cos \gamma ).}
  


== Analogue for tetrahedra ==
An analogous statement begins by taking α, β, γ, δ to be the areas of the four faces of a tetrahedron. Denote the dihedral angles by 
  
    
      
        
          
            
              
                β
                γ
              
              ^
            
          
        
      
    
    {\displaystyle {\widehat {\beta \gamma }}}
   etc. Then

  
    
      
        
          α
          
            2
          
        
        =
        
          β
          
            2
          
        
        +
        
          γ
          
            2
          
        
        +
        
          δ
          
            2
          
        
        −
        2
        
          [
          
            β
            γ
            cos
            ⁡
            
              (
              
                
                  
                    
                      β
                      γ
                    
                    ^
                  
                
              
              )
            
            +
            γ
            δ
            cos
            ⁡
            
              (
              
                
                  
                    
                      γ
                      δ
                    
                    ^
                  
                
              
              )
            
            +
            δ
            β
            cos
            ⁡
            
              (
              
                
                  
                    
                      δ
                      β
                    
                    ^
                  
                
              
              )
            
          
          ]
        
        .
      
    
    {\displaystyle \alpha ^{2}=\beta ^{2}+\gamma ^{2}+\delta ^{2}-2\left[\beta \gamma \cos \left({\widehat {\beta \gamma }}\right)+\gamma \delta \cos \left({\widehat {\gamma \delta }}\right)+\delta \beta \cos \left({\widehat {\delta \beta }}\right)\right].}
  


== Version suited to small angles ==
When the angle, γ, is small and the adjacent sides, a and b, are of similar length, the right hand side of the standard form of the law of cosines is subject to catastrophic cancellation in numerical approximations. In situations where this is an important concern, a mathematically equivalent version of the law of cosines, similar to the haversine formula, can prove useful:

  
    
      
        
          
            
              
                
                  c
                  
                    2
                  
                
              
              
                
                =
                (
                a
                −
                b
                
                  )
                  
                    2
                  
                
                +
                4
                a
                b
                
                  sin
                  
                    2
                  
                
                ⁡
                
                  (
                  
                    
                      γ
                      2
                    
                  
                  )
                
              
            
            
              
              
                
                =
                (
                a
                −
                b
                
                  )
                  
                    2
                  
                
                +
                4
                a
                b
                haversin
                ⁡
                (
                γ
                )
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}c^{2}&=(a-b)^{2}+4ab\sin ^{2}\left({\frac {\gamma }{2}}\right)\\&=(a-b)^{2}+4ab\operatorname {haversin} (\gamma ).\end{aligned}}}
  In the limit of an infinitesimal angle, the law of cosines degenerates into the circular arc length formula, c = a γ.


== In spherical and hyperbolic geometry ==

Versions similar to the law of cosines for the Euclidean plane also hold on a unit sphere and in a hyperbolic plane. In spherical geometry, a triangle is defined by three points u, v, and w on the unit sphere, and the arcs of great circles connecting those points. If these great circles make angles A, B, and C with opposite sides a, b, c then the spherical law of cosines asserts that both of the following relationships hold:

  
    
      
        
          
            
              
                cos
                ⁡
                a
              
              
                
                =
                cos
                ⁡
                b
                cos
                ⁡
                c
                +
                sin
                ⁡
                b
                sin
                ⁡
                c
                cos
                ⁡
                A
              
            
            
              
                cos
                ⁡
                A
              
              
                
                =
                −
                cos
                ⁡
                B
                cos
                ⁡
                C
                +
                sin
                ⁡
                B
                sin
                ⁡
                C
                cos
                ⁡
                a
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}\cos a&=\cos b\cos c+\sin b\sin c\cos A\\\cos A&=-\cos B\cos C+\sin B\sin C\cos a.\end{aligned}}}
  In hyperbolic geometry, a pair of equations are collectively known as the hyperbolic law of cosines. The first is

  
    
      
        cosh
        ⁡
        a
        =
        cosh
        ⁡
        b
        cosh
        ⁡
        c
        −
        sinh
        ⁡
        b
        sinh
        ⁡
        c
        cos
        ⁡
        A
      
    
    {\displaystyle \cosh a=\cosh b\cosh c-\sinh b\sinh c\cos A}
  where sinh and cosh are the hyperbolic sine and cosine, and the second is

  
    
      
        cos
        ⁡
        A
        =
        −
        cos
        ⁡
        B
        cos
        ⁡
        C
        +
        sin
        ⁡
        B
        sin
        ⁡
        C
        cosh
        ⁡
        a
        .
      
    
    {\displaystyle \cos A=-\cos B\cos C+\sin B\sin C\cosh a.}
  As in Euclidean geometry, one can use the law of cosines to determine the angles A, B, C from the knowledge of the sides a, b, c. In contrast to Euclidean geometry, the reverse is also possible in both non-Euclidean models: the angles A, B, C determine the sides a, b, c.


== See also ==
Half-side formula
Law of sines
Law of tangents
Law of cotangents
List of trigonometric identities
Mollweide's formula


== References ==


== External links ==

"Cosine theorem", Encyclopedia of Mathematics, EMS Press, 2001 [1994]
Several derivations of the Cosine Law, including Euclid's at cut-the-knot
Interactive applet of Law of Cosines